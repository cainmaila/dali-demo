!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Dali=e()}(this,function(){"use strict";var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;this.master=t,this.list=[],this.argList=[],this.timerId=-1,this.waitTimer=e};t.prototype.push=function(){var t=Array.prototype.slice.call(arguments),e=this;e.list.push(t.shift()),e.argList.push(t),-1===e.timerId&&(e.list.pop().apply(e.master,e.argList.pop()),e.list.length=0,e.argList.length=0),e.timerId=setInterval(function(){0===e.list.length?(clearTimeout(e.timerId),e.timerId=-1):(e.list.pop().apply(e.master,e.argList.pop()),e.list.length=0,e.argList.length=0)},e.waitTimer)};var e={core:null,coreUrl:"",init:function(e){var i=e.viewId,n=e.coreUrl,s=document.getElementById(i);if(!s)throw"viewer id is not find !";this.core=document.createElement("iframe"),this.core.setAttribute("frameborder","0"),this.core.style.width="100%",this.core.style.height="100%",s.appendChild(this.core),this.coreUrl=n,this._brightnessEventList=new t(this,200),this._backgroundColorEventList=new t(this,200),this._cutRangeEventList=new t(this,200),this._animnameTimeEventList=new t(this,200),this._explosionIntervalEventList=new t(this,200)},load:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ang:0,pit:0,color:"f00"},i=e.ang,n=e.pit,s=e.color;if(!t)throw"path can not be empty !";"#"===s.charAt(0)&&(s=s.substr(1)),t=this.coreUrl+"?path="+t+"&ang="+i+"&pit="+n+"&color="+s,this.core.setAttribute("src",t)},postMessage:function(t){this.core.contentWindow.postMessage(t,"*")},lockRotate:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.postMessage({act:"rotMode",val:t})},setViewPosition:function(t){this.postMessage({act:"angchg",val:""+t})},lockAxis:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"rotate",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.postMessage({act:"axisLock",val:{lockType:t,axis:e}})},setZoom:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.postMessage({act:"zoom",val:t})},setZoomMode:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.postMessage({act:"leftZoomMode",val:t})},getSceneStatus:function(){this.postMessage({act:"Dali_CAMERA_GET_STATUS"})},setSceneStatus:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t)throw"status can not be empty !";this.postMessage({act:"cam_status",val:t})},resetCamera:function(){this.postMessage({act:"rest"})},setQuality:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.postMessage({act:"quality",val:t})},_brightnessEventList:null,setBrightness:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._brightnessEventList.push(this.postMessage,{act:"brightness",val:t})},_backgroundColorEventList:null,setBackgroundColor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._backgroundColorEventList.push(this.postMessage,{act:"bg",val:t})},changeMeasureUnit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"m";this.postMessage({act:"unit",val:t})},enableMeasure:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.postMessage({act:"measuring",val:t})},setCutMethod:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.postMessage({act:"cutting",val:t})},_cutRangeEventList:null,setCutRange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;this._cutRangeEventList.push(this.postMessage,{act:"cut_range",val:t})},reverseCutDirection:function(){this.postMessage({act:"cut_rev"})},clearCut:function(){this.postMessage({act:"cut_cancel"})},getInfoNodeList:function(){this.postMessage({act:"getInfoNode"})},track2dPosition:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.postMessage({act:"d3_track",val:t})},clearSelectedEntity:function(){this.postMessage({act:"entity_cancel"})},getEntityTreeNode:function(t,e){this.postMessage({act:"treeNode",val:{stName:t,stPath:e}})},selectEntityTreeNode:function(t,e){this.postMessage({act:"selectTreeNode",val:{stName:t,stPath:e}})},_animnameTimeEventList:null,setAnimnameTime:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this._animnameTimeEventList.push(this.postMessage,{act:"animname",val:{animname:t,animTime:e}})},_explosionIntervalEventList:null,setExplosionInterval:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._explosionIntervalEventList.push(this.postMessage,{act:"explosive",val:{off:!!t,val:t?2*t:0}})},enableDefaultUi:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.postMessage({act:"ui",val:t})},enablePipelineLink:function(){this.postMessage({act:"ass",val:f_})},destroy:function(){this.core.remove(),this.core=null}},i={init:function(){window.addEventListener("message",this.onMessage)},onMessage:function(t){switch(t.data.act){case"ready":this.Dali.onReady(t.data.val);break;case"loading":t.data.val?this.Dali.onLoadStart():this.Dali.onLoadFinish();break;case"x3rest":this.Dali.onDefaultUiRestFinish();break;case"measure":this.Dali.onMeasureFinish(t.data.val);break;case"infoNode":this.Dali.onGetInfoNodeList(t.data.val);break;case"track_po":this.Dali.onTrack2dPosition(t.data.val);break;case"depth":this.Dali.onTrack3dDepth(t.data.val);break;case"entity":this.Dali.onSelectEntity(t.data.val);break;case"x3.tree":this.Dali.onGetEntityTreeRoot(t.data.val);break;case"x3.treeNode":this.Dali.onGetEntityTreeNode(t.data.val);break;case"x3.treeNode":this.Dali.onGetSceneStatus(t.data.val)}},destroy:function(){window.removeEventListener("message",this.onMessage)}};console.info("Dali Core SDK v1.0.2");return{fn:e,view:i,init:function(t){var n=t.viewId,s=t.coreUrl;if(!window)throw"window is not find !";if(!document)throw"document is not find !";if(!n)throw"viewId can not be empty !";if(!s)throw"coreUrl can not be empty !";i.init(),e.init({viewId:n,coreUrl:s})},onReady:function(t){},onLoadStart:function(){},onLoadFinish:function(){},onDefaultUiRestFinish:function(){},onMeasureFinish:function(){},onGetInfoNodeList:function(t){},onSelectEntity:function(t){},onGetEntityTreeRoot:function(t){},onGetEntityTreeNode:function(t){},onMeasureResponse:function(t){},onTrack2dPosition:function(t){},onTrack3dDepth:function(t){},onGetSceneStatus:function(t){},destroy:function(){this.fn=null,this.view=null,e.destroy(),i.destroy()}}});
